# Calculating and then visualizing SNP density of the northern elephant seal genome by chromosome 
I will be running an analysis to calculate snp density of the northern elephant seal genome using a sliding window approach, then visualize in R by chromosome. I have adopted this method of visualizing whole-genome diversity from the SMSC class I attended last year :) yay! So that means this commande line + R code has been co-opted from code generated by Henrique Figuiero. 

I will be utilizing a combination of GATK and VCFTool commands to call variants then use a sliding window approach to calculate overall snp density. (will reword this later) 

# Step 1: Generate vcf file using GATK  

The first step is to use GATK to mark duplicates from the alignment file. 

    gatk AddOrReplaceReadGroups -I=SRR25478315_eseal_sorted_reads_duplMarked.bam -O=SRR25478315_eseal_sorted_reads_duplMarked_SM.bam -ID=1 -LB=lib1 -PL=ILLUMINA -PU=unit1 -SM=SRR25478315

Index the duplicate marked bam file 

    samtools index SRR25478315_eseal_sorted_reads_duplMarked_SM.bam
    
Create the variant call file 

    rungatk HaplotypeCaller -I /scratch1/migriver_CCGP/ncbi_dataset/omnic_mapfiles/SRR25478315_eseal_sorted_reads_duplMarked_SM.bam -R /scratch1/migriver_CCGP/ncbi_dataset/20230202.mMirAng1.NCBI.hap1.fasta -ERC GVCF -O SRR25478315_eseal.g.vcf.gz

# Step 2: Use VCFTools to calculate snp density 

Use VCFTools to call heterozygous sites

    vcftools --gzvcf SRR25478315_eseal.g.vcf.gz --recode --out SRR25478315_eseal_HD_PASS_DP5_hetsites --maf 0.1

Use VCFTools to calculate snp density of the called heterozygous sites using a sliding window approach 

    vcftools --vcf SRR25478315_eseal_HD_PASS_DP5_hetsites.recode.vcf --SNPdensity 1000000 --out SRR25478315_eseal_HD_PASS_DP5_hetsites

Transform the generated .snpden file into a human-readable file with appropriate headers 

    awk -v sample="SRR2547831" 'NR==1{print $0"\tIndiv"} NR>1{print $0"\t"sample}' SRR25478315_eseal_HD_PASS_DP5_hetsites.snpden > SRR25478315_eseal_HD_PASS_DP5_hetsites_id.snpden
